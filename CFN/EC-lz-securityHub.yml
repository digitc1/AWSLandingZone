AWSTemplateFormatVersion: 2010-09-09

#   --------------------------------------------------------
#   Version History
#
#   v1.0  J. Vandenbergen   Initial Version
#   --------------------------------------------------------

Description: >-
  v1.0. Script to create SecurityHub in SecLog master accountS

Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      -
        Label:
          default: "Tags"
        Parameters:
          - Owner
          - Project
          - Environment
          - Criticity
          - DataClassification

Parameters:
  Owner:
      Description: "Tag: owner. Creator or responsible for the project"
      Type: String
      Default: ''

  Environment:
      Description: "Tag: environment. Environnement of the resource (Dev, test, prod etc.)"
      Type: String
      Default: ''

  Criticity:
      Description: "Tag: criticity. Criticity of the application"
      Type: String
      Default: ''

  Project:
      Description: "Tag: project. Name of the application or project"
      Type: String
      Default: 'secLZ'

  DataClassification:
      Description: "Tag: data-classification. Level of criticality of the stored data"
      Type: String
      Default: ''

Resources:
  rSecHubWithTags:
    Type: "AWS::SecurityHub::Hub"
    Properties:
      Tags:
      - Key: Owner
        Value: !Ref Owner
      - Key: Environment
        Value: !Ref Environment
      - Key: Criticity
        Value: !Ref Criticity
      - Key: Project
        Value: !Ref Project
      - Key: DataClassification
        Value: !Ref DataClassification

Outputs:
  HubArn:
    Value: !Ref rSecHubWithTags